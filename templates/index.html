{% extends 'base.html' %}
{% block content %}

<h2 class="text-center mb-4">Our Journey Stories</h2>

<div class="row">
{% for j in journeys %}
  <div class="col-md-6 mb-4">
    <div class="card journey-card shadow-4">

      {% if j.images.all|length > 0 %}
      <div class="image-wrapper"
           onmouseenter="playSong('{{ j.id }}')"
           onmouseleave="stopSong('{{ j.id }}')">

        <img src="{{ j.images.all.0.image.url }}" class="journey-img">

        {% if j.song %}
        <audio id="audio-{{ j.id }}">
          <source src="{{ j.song.url }}" type="audio/mpeg">
        </audio>
        {% endif %}
      </div>
      {% endif %}

      <div class="card-body">
        <h5>{{ j.title }}</h5>
        <p class="text-muted">{{ j.location }}</p>

        <a href="{% url 'blog_detail' j.id %}" class="btn btn-primary btn-sm">READ</a>

        {% if user == j.author %}
          <a href="{% url 'edit_journey' j.id %}" class="btn btn-warning btn-sm">EDIT</a>
          <a href="{% url 'delete_journey' j.id %}" class="btn btn-danger btn-sm">DELETE</a>
        {% endif %}
      </div>
    </div>
  </div>
{% endfor %}
</div>

<script>
function playSong(id) {
  const audio = document.getElementById('audio-' + id);
  if (audio) {
    audio.volume = 0.5;
    audio.play();
  }
}
function stopSong(id) {
  const audio = document.getElementById('audio-' + id);
  if (audio) {
    audio.pause();
    audio.currentTime = 0;
  }
}
</script>

{% endblock %}
